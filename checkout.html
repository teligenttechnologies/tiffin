<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>fittin tiffin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      /* Scrollbar for cart items */
      #cart-items::-webkit-scrollbar {
        width: 8px;
      }
      #cart-items::-webkit-scrollbar-track {
        background: #131313;
        border-radius: 100px;
      }
      #cart-items::-webkit-scrollbar-thumb {
        background-color: #131312;
        border-radius: 100px;
      }
    </style>
  </head>
  <body
    class="bg-gradient-to-tr from-yellow-400 via-yellow-300 to-yellow-200 min-h-screen flex flex-col font-sans"
  >
    <header
      class="bg-yellow-500 shadow-md py-5 px-8 flex justify-between items-center sticky top-0 z-50"
    >
      <h1
        class="text-3xl font-extrabold text-yellow-900 tracking-wide select-none"
      >
        POSH: TIFFIN TIFFIN:
      </h1>
      <a
        href="index.html"
        class="text-yellow-900 font-semibold hover:underline hover:text-yellow-700 transition duration-300"
        >← Continue Shopping</a
      >
    </header>

    <main
      class="flex-grow max-w-6xl mx-auto p-6 sm:p-12 grid grid-cols-1 md:grid-cols-2 gap-12"
    >
      <!-- CART SECTION -->
      <section
        class="bg-white bg-opacity-90 rounded-3xl shadow-2xl p-8 flex flex-col"
      >
        <h2
          class="text-3xl font-bold mb-8 text-yellow-700 border-b-4 border-yellow-400 pb-3 w-max select-none"
        >
          Your Cart
        </h2>

        <div
          id="cart-items"
          class="flex-grow overflow-y-auto space-y-5 max-h-[60vh]"
        >
          <!-- Cart items injected here -->
        </div>

        <div
          class="mt-8 border-t border-yellow-300 pt-6 flex justify-between items-center select-none"
        >
          <span class="text-2xl font-semibold text-yellow-800 tracking-wide"
            >Total:</span
          >
          <span id="cart-total" class="text-3xl font-extrabold text-yellow-900"
            >₹0</span
          >
        </div>
      </section>

      <!-- CHECKOUT FORM -->
      <section
        class="bg-white bg-opacity-90 rounded-3xl shadow-2xl p-8 flex flex-col"
      >
        <h2
          class="text-3xl font-bold mb-8 text-yellow-700 border-b-4 border-yellow-400 pb-3 w-max select-none"
        >
          Checkout
        </h2>

        <form id="checkout-form" class="space-y-8 flex flex-col">
          <!-- Shipping Details -->
          <div class="space-y-5">
            <label class="block font-semibold text-yellow-800">Full Name</label>
            <input
              type="text"
              id="name"
              name="name"
              required
              placeholder="John Doe"
              class="w-full border border-yellow-400 rounded-2xl px-5 py-3 text-yellow-900 font-semibold placeholder-yellow-400 focus:outline-none focus:ring-4 focus:ring-yellow-400 transition"
            />
          </div>
          <div class="space-y-5">
            <label class="block font-semibold text-yellow-800"
              >Email Address</label
            >
            <input
              type="email"
              id="email"
              name="email"
              required
              placeholder="john@example.com"
              class="w-full border border-yellow-400 rounded-2xl px-5 py-3 text-yellow-900 font-semibold placeholder-yellow-400 focus:outline-none focus:ring-4 focus:ring-yellow-400 transition"
            />
          </div>
          <div class="space-y-5">
            <label class="block font-semibold text-yellow-800"
              >Shipping Address</label
            >
            <textarea
              id="address"
              name="address"
              rows="3"
              required
              placeholder="123 Main Street, City, State, Zip"
              class="w-full border border-yellow-400 rounded-2xl px-5 py-3 text-yellow-900 font-semibold placeholder-yellow-400 resize-none focus:outline-none focus:ring-4 focus:ring-yellow-400 transition"
            ></textarea>
          </div>

          <!-- Payment Method -->
          <div class="space-y-5">
            <label class="block font-semibold text-yellow-800 select-none"
              >Select Payment Method</label
            >
            <div class="flex flex-wrap gap-6">
              <label class="flex items-center space-x-3 cursor-pointer">
                <input
                  type="radio"
                  name="paymentMethod"
                  value="card"
                  checked
                  class="form-radio text-yellow-500"
                />
                <span class="font-semibold text-yellow-800"
                  >Credit / Debit Card</span
                >
              </label>
              <label class="flex items-center space-x-3 cursor-pointer">
                <input
                  type="radio"
                  name="paymentMethod"
                  value="upi"
                  class="form-radio text-yellow-500"
                />
                <span class="font-semibold text-yellow-800">UPI</span>
              </label>
              <label class="flex items-center space-x-3 cursor-pointer">
                <input
                  type="radio"
                  name="paymentMethod"
                  value="cod"
                  class="form-radio text-yellow-500"
                />
                <span class="font-semibold text-yellow-800"
                  >Cash on Delivery (COD)</span
                >
              </label>
            </div>
          </div>

          <!-- Card Payment -->
          <div id="card-payment-form" class="space-y-3">
            <input
              type="text"
              id="card-number"
              name="cardNumber"
              maxlength="19"
              placeholder="Card Number (1234 5678 9012 3456)"
              required
              pattern="[\d ]{13,19}"
              class="w-full border border-yellow-400 rounded-2xl px-5 py-3 text-yellow-900 font-semibold placeholder-yellow-400 focus:outline-none focus:ring-4 focus:ring-yellow-400 transition"
            />
            <div class="flex gap-6">
              <input
                type="text"
                id="expiry"
                name="expiry"
                maxlength="5"
                placeholder="Expiry (MM/YY)"
                required
                pattern="(0[1-9]|1[0-2])\/?([0-9]{2})"
                class="flex-1 border border-yellow-400 rounded-2xl px-5 py-3 text-yellow-900 font-semibold placeholder-yellow-400 focus:outline-none focus:ring-4 focus:ring-yellow-400 transition"
              />
            </div>
            <div class="flex gap-6">
                <input
                type="password"
                id="cvv"
                name="cvv"
                maxlength="3"
                placeholder="CVV"
                required
                pattern="[0-9]{3}"
                inputmode="numeric"
                autocomplete="off"
                class="flex-1 border border-yellow-400 rounded-2xl px-5 py-3 text-yellow-700 font-semibold placeholder-yellow-400 focus:outline-none focus:ring-4 focus:ring-yellow-400 transition"
              />
            </div>
          </div>

          <!-- UPI Payment -->
          <div id="upi-payment-form" class="hidden space-y-5">
            <input
              type="text"
              id="upi-id"
              name="upiId"
              placeholder="Enter your UPI ID (example@upi)"
              pattern="^[\w.-]+@[\w.-]+$"
              class="w-full border border-yellow-400 rounded-2xl px-5 py-3 text-yellow-900 font-semibold placeholder-yellow-400 focus:outline-none focus:ring-4 focus:ring-yellow-400 transition"
            />
          </div>

          <!-- COD Info -->
          <div
            id="cod-message"
            class="hidden p-4 rounded-xl bg-yellow-100 border border-yellow-400 text-yellow-900 font-semibold select-none"
          >
            You selected <strong>Cash on Delivery</strong>. Please keep the
            exact amount ready when delivery arrives.
          </div>

          <button
            type="submit"
            class="w-full py-4 mt-4 bg-yellow-500 text-yellow-900 font-extrabold rounded-3xl shadow-lg hover:bg-yellow-400 hover:shadow-xl transition duration-300 select-none"
          >
            Place Order
          </button>
        </form>
      </section>
    </main>

    <footer
      class="bg-yellow-400 text-yellow-900 text-center py-6 mt-12 font-semibold select-none shadow-inner"
    >
      &copy; 2025 INTERHAUL LOGISTICS - Made with ❤️ by You
    </footer>

    <script>
      // CART MANAGEMENT
      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      const cartItemsContainer = document.getElementById("cart-items");
      const cartTotalEl = document.getElementById("cart-total");

      function saveCart() {
        localStorage.setItem("cart", JSON.stringify(cart));
      }

      function calculateTotal() {
        return cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
      }

      function renderCart() {
        if (cart.length === 0) {
          cartItemsContainer.innerHTML =
            '<p class="text-yellow-700 font-semibold text-center select-none">Your cart is empty!</p>';
          cartTotalEl.textContent = "₹0";
          return;
        }

        cartItemsContainer.innerHTML = "";

        cart.forEach((item, idx) => {
          const itemEl = document.createElement("div");
          itemEl.className =
            "flex items-center space-x-5 border border-yellow-300 rounded-xl p-3 bg-yellow-50 shadow-inner";

          itemEl.innerHTML = `
          <img src="${item.image}" alt="${
            item.name
          }" class="w-20 h-20 object-cover rounded-xl shadow-md" />
          <div class="flex flex-col flex-grow">
            <h3 class="font-semibold text-yellow-700">${item.name}</h3>
            <p class="text-yellow-600">₹${item.price} each</p>
            <div class="mt-2 flex items-center space-x-3">
              <button data-idx="${idx}" class="decrease-btn bg-yellow-300 hover:bg-yellow-400 rounded-full px-3 font-bold text-yellow-900 transition select-none">-</button>
              <span class="font-semibold text-yellow-900 select-none">${
                item.quantity
              }</span>
              <button data-idx="${idx}" class="increase-btn bg-yellow-300 hover:bg-yellow-400 rounded-full px-3 font-bold text-yellow-900 transition select-none">+</button>
            </div>
          </div>
          <div class="flex flex-col items-end space-y-2">
            <span class="text-yellow-900 font-bold text-lg select-none">₹${
              item.price * item.quantity
            }</span>
            <button data-idx="${idx}" class="remove-btn bg-yellow-500 hover:bg-yellow-600 text-yellow-900 rounded-lg px-3 py-1 font-semibold transition select-none">
              Remove
            </button>
          </div>
        `;

          cartItemsContainer.appendChild(itemEl);
        });

        cartTotalEl.textContent = "₹" + calculateTotal();

        // Attach listeners after rendering
        document.querySelectorAll(".decrease-btn").forEach((btn) => {
          btn.onclick = () => {
            const i = +btn.dataset.idx;
            if (cart[i].quantity > 1) {
              cart[i].quantity--;
              saveCart();
              renderCart();
            }
          };
        });

        document.querySelectorAll(".increase-btn").forEach((btn) => {
          btn.onclick = () => {
            const i = +btn.dataset.idx;
            cart[i].quantity++;
            saveCart();
            renderCart();
          };
        });

        document.querySelectorAll(".remove-btn").forEach((btn) => {
          btn.onclick = () => {
            const i = +btn.dataset.idx;
            cart.splice(i, 1);
            saveCart();
            renderCart();
          };
        });
      }

      renderCart();

      // CHECKOUT FORM LOGIC
      const paymentRadios = document.querySelectorAll(
        'input[name="paymentMethod"]'
      );
      const cardForm = document.getElementById("card-payment-form");
      const upiForm = document.getElementById("upi-payment-form");
      const codMessage = document.getElementById("cod-message");
      const checkoutForm = document.getElementById("checkout-form");

      function updatePaymentUI() {
        const selected = document.querySelector(
          'input[name="paymentMethod"]:checked'
        ).value;
        if (selected === "card") {
          cardForm.classList.remove("hidden");
          upiForm.classList.add("hidden");
          codMessage.classList.add("hidden");
          setRequired(cardForm, true);
          setRequired(upiForm, false);
        } else if (selected === "upi") {
          cardForm.classList.add("hidden");
          upiForm.classList.remove("hidden");
          codMessage.classList.add("hidden");
          setRequired(cardForm, false);
          setRequired(upiForm, true);
        } else {
          cardForm.classList.add("hidden");
          upiForm.classList.add("hidden");
          codMessage.classList.remove("hidden");
          setRequired(cardForm, false);
          setRequired(upiForm, false);
        }
      }

      function setRequired(formSection, state) {
        [...formSection.querySelectorAll("input")].forEach((input) => {
          if (state) input.setAttribute("required", "required");
          else input.removeAttribute("required");
        });
      }

      paymentRadios.forEach((radio) => {
        radio.addEventListener("change", updatePaymentUI);
      });

      updatePaymentUI();

      checkoutForm.addEventListener("submit", (e) => {
        e.preventDefault();

        if (cart.length === 0) {
          alert("Your cart is empty. Add items before checkout.");
          return;
        }

        if (!checkoutForm.checkValidity()) {
          alert("Please fill all required fields correctly.");
          return;
        }

        // Simulate order processing
        const orderDetails = {
          name: checkoutForm.name.value,
          email: checkoutForm.email.value,
          address: checkoutForm.address.value,
          paymentMethod: checkoutForm.paymentMethod.value,
          cartItems: cart,
          totalAmount: calculateTotal(),
          orderTime: new Date().toLocaleString(),
        };

        console.log("Order placed:", orderDetails);

        alert(
          `Thank you, ${orderDetails.name}! Your order of ₹${orderDetails.totalAmount} has been placed.`
        );

        // Clear cart & form
        cart = [];
        saveCart();
        renderCart();
        checkoutForm.reset();
        updatePaymentUI();
      });
    </script>
  </body>
</html>
